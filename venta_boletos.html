<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venta de Boletos | SistemaAéreo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="CSS/estilos.css">
</head>

<body class="has-navbar">
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <i class="fas fa-plane"></i>
            SistemaAéreo
        </a>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    Inicio
                </a>
            </li>
            <li class="nav-item">
                <a href="vuelos.html" class="nav-link">
                    <i class="fas fa-plane"></i>
                    Vuelos
                </a>
            </li>
            <li class="nav-item">
                <a href="pasajeros.html" class="nav-link">
                    <i class="fas fa-users"></i>
                    Pasajeros
                </a>
            </li>
            <li class="nav-item">
                <a href="aerolineas.html" class="nav-link">
                    <i class="fas fa-headset"></i>
                    Aerolíneas
                </a>
            </li>
            <li class="nav-item">
                <a href="venta_boletos.html" class="nav-link active">
                    <i class="fas fa-ticket-alt"></i>
                    Boletos
                </a>
            </li>
        </ul>
    </nav>

    <main>
        <div class="container my-4 p-4 bg-white rounded shadow" style="max-width: 800px;">
            <h3 class="mb-4">Venta de Boletos</h3>

            <form id="boletoForm">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">Pasajero:</label>
                        <select class="form-select" id="pasajero" required>
                            <option value="" selected disabled>Seleccione un pasajero</option>
                            <!-- Opciones se llenarán dinámicamente -->
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Vuelo:</label>
                        <select class="form-select" id="vuelo" required>
                            <option value="" selected disabled>Seleccione un vuelo</option>
                            <!-- Opciones se llenarán dinámicamente -->
                        </select>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Fecha de reserva:</label>
                        <input type="date" class="form-control" id="fechaReserva" required>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Asiento:</label>
                        <input type="text" class="form-control" id="asiento" placeholder="Ej: 12A" required>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Clase:</label>
                        <select class="form-select" id="clase" required>
                            <option value="" selected disabled>Seleccione clase</option>
                            <option value="Economica">Económica</option>
                            <option value="Ejecutiva">Ejecutiva</option>
                            <option value="Primera">Primera Clase</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Precio ($):</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" id="precio" min="0" step="0.01" required>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Estado del boleto:</label>
                        <select class="form-select" id="estado" required>
                            <option value="" selected disabled>Seleccione un estado</option>
                            <option value="Reservado">Reservado</option>
                            <option value="Confirmado">Confirmado</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                    </div>

                    <div class="col-12">
                        <label class="form-label">Servicios adicionales:</label>
                        <div class="row">
                            <div class="col-md-3 col-6 mb-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="sillaRuedas" value="Silla de ruedas">
                                    <label class="form-check-label" for="sillaRuedas">Silla de ruedas</label>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="mascota" value="Mascota">
                                    <label class="form-check-label" for="mascota">Transporte de mascota</label>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="comidaEspecial" value="Comida especial">
                                    <label class="form-check-label" for="comidaEspecial">Comida especial</label>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="asistenciaMedica" value="Asistencia médica">
                                    <label class="form-check-label" for="asistenciaMedica">Asistencia médica</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 mt-3 text-center">
                        <button type="submit" class="btn btn-primary me-2" id="btnGuardar">Guardar Boleto</button>
                        <button type="button" class="btn btn-secondary" id="btnCancelar">Cancelar</button>
                    </div>
                </div>
            </form>
        </div>

        <div class="table-container mt-4">
            <h2>Boletos Vendidos</h2>
            <table id="tablaBoletos" class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Pasajero</th>
                        <th>Vuelo</th>
                        <th>Fecha Reserva</th>
                        <th>Asiento</th>
                        <th>Clase</th>
                        <th>Precio</th>
                        <th>Estado</th>
                        <th>Servicios</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </main>

    <footer>
        <p>Sistema de Gestión de Vuelos &copy; 2023 - SistemaAéreo</p>
        <p>Versión 1.0.0</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('boletoForm');
            const tabla = document.querySelector('#tablaBoletos tbody');
            let editIndex = -1;
            let boletos = [];

            // Cargar datos de ejemplo (opcional)
            cargarDatosEjemplo();

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const servicios = [];
                if (document.getElementById('sillaRuedas').checked) servicios.push('Silla de ruedas');
                if (document.getElementById('mascota').checked) servicios.push('Mascota');
                if (document.getElementById('comidaEspecial').checked) servicios.push('Comida especial');
                if (document.getElementById('asistenciaMedica').checked) servicios.push('Asistencia médica');

                const boleto = {
                    pasajero: document.getElementById('pasajero').value,
                    vuelo: document.getElementById('vuelo').value,
                    fechaReserva: document.getElementById('fechaReserva').value,
                    asiento: document.getElementById('asiento').value,
                    clase: document.getElementById('clase').value,
                    precio: parseFloat(document.getElementById('precio').value).toFixed(2),
                    estado: document.getElementById('estado').value,
                    servicios: servicios.join(', ')
                };

                if (editIndex === -1) {
                    agregarBoleto(boleto);
                } else {
                    actualizarBoleto(editIndex, boleto);
                    editIndex = -1;
                    document.getElementById('btnGuardar').textContent = 'Guardar Boleto';
                }

                form.reset();
            });

            document.getElementById('btnCancelar').addEventListener('click', function() {
                if (confirm('¿Desea cancelar y limpiar el formulario?')) {
                    form.reset();
                    editIndex = -1;
                    document.getElementById('btnGuardar').textContent = 'Guardar Boleto';
                }
            });

            function cargarDatosEjemplo() {
                // Opcional: Datos de ejemplo iniciales
                const pasajerosSelect = document.getElementById('pasajero');
                const vuelosSelect = document.getElementById('vuelo');
                
                pasajerosSelect.innerHTML = '<option value="" selected disabled>Seleccione un pasajero</option>';
                vuelosSelect.innerHTML = '<option value="" selected disabled>Seleccione un vuelo</option>';
                
                const pasajerosEjemplo = [
                    'Juan Rodriguez - PAS123456',
                    'Amelia Salazar - PAS654321',
                    'Karina Vasquez - PAS987654'
                ];
                
                const vuelosEjemplo = [
                    'LA678 - Lima a Bogotá - 15/06/2023',
                    'DE890 - Quito a Miami - 16/06/2023',
                    'AV654 - Bogotá a Madrid - 17/06/2023'
                ];
                
                pasajerosEjemplo.forEach(p => {
                    const option = document.createElement('option');
                    option.value = p;
                    option.textContent = p;
                    pasajerosSelect.appendChild(option);
                });
                
                vuelosEjemplo.forEach(v => {
                    const option = document.createElement('option');
                    option.value = v;
                    option.textContent = v;
                    vuelosSelect.appendChild(option);
                });
            }

            function agregarBoleto(boleto) {
                const fila = tabla.insertRow();
                llenarFila(fila, boleto);
                boletos.push(boleto);
            }

            function llenarFila(fila, boleto) {
                const celdas = [
                    tabla.rows.length,
                    boleto.pasajero,
                    boleto.vuelo,
                    boleto.fechaReserva,
                    boleto.asiento,
                    boleto.clase,
                    `$${boleto.precio}`,
                    `<span class="badge ${getBadgeClass(boleto.estado)}">${boleto.estado}</span>`,
                    boleto.servicios || 'Ninguno'
                ];

                celdas.forEach(texto => {
                    const celda = fila.insertCell();
                    celda.innerHTML = texto;
                });

                const celdaAcciones = fila.insertCell();
                celdaAcciones.innerHTML = `
                    <i class="fas fa-eye icono-accion text-primary mx-1" title="Ver" onclick="verBoleto(this)"></i>
                    <i class="fas fa-edit icono-accion text-warning mx-1" title="Editar" onclick="editarBoleto(${tabla.rows.length - 1})"></i>
                    <i class="fas fa-trash-alt icono-accion text-danger mx-1" title="Eliminar" onclick="eliminarBoleto(${tabla.rows.length - 1})"></i>
                `;
            }

            function getBadgeClass(estado) {
                switch(estado) {
                    case 'Confirmado': return 'bg-success';
                    case 'Cancelado': return 'bg-danger';
                    default: return 'bg-primary';
                }
            }

            window.verBoleto = function(icono) {
                const fila = icono.closest('tr');
                const celdas = fila.cells;
                
                const mensaje = `
                    Detalles del Boleto:
                    ID: ${celdas[0].textContent}
                    Pasajero: ${celdas[1].textContent}
                    Vuelo: ${celdas[2].textContent}
                    Fecha Reserva: ${celdas[3].textContent}
                    Asiento: ${celdas[4].textContent}
                    Clase: ${celdas[5].textContent}
                    Precio: ${celdas[6].textContent}
                    Estado: ${celdas[7].textContent}
                    Servicios: ${celdas[8].textContent}
                `;
                
                alert(mensaje);
            };

            window.editarBoleto = function(index) {
                const boleto = boletos[index];
                document.getElementById('pasajero').value = boleto.pasajero;
                document.getElementById('vuelo').value = boleto.vuelo;
                document.getElementById('fechaReserva').value = boleto.fechaReserva;
                document.getElementById('asiento').value = boleto.asiento;
                document.getElementById('clase').value = boleto.clase;
                document.getElementById('precio').value = boleto.precio;
                document.getElementById('estado').value = boleto.estado;
                
                // checkboxes de servicios
                const servicios = boleto.servicios.split(', ');
                document.getElementById('sillaRuedas').checked = servicios.includes('Silla de ruedas');
                document.getElementById('mascota').checked = servicios.includes('Mascota');
                document.getElementById('comidaEspecial').checked = servicios.includes('Comida especial');
                document.getElementById('asistenciaMedica').checked = servicios.includes('Asistencia médica');
                
                editIndex = index;
                document.getElementById('btnGuardar').textContent = 'Actualizar Boleto';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            window.eliminarBoleto = function(index) {
                if (confirm('¿Está seguro de eliminar este boleto?')) {
                    tabla.deleteRow(index);
                    boletos.splice(index, 1);
                    
                    const filas = tabla.querySelectorAll('tr');
                    filas.forEach((fila, i) => {
                        fila.cells[0].textContent = i + 1;
                    });
                }
            };
        });
    </script>
</body>
</html>